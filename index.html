<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Poker 2025/2026 ‚Äì Dashboard m√≥vil</title>
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React UMD + Babel for JSX in a single HTML file -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    /* util para ocultar scrollbars en tabs m√≥viles */
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    html, body { height: 100%; background: rgb(236 253 245 / 0.4); }
  </style>
</head>
<body class="text-gray-900">
  <div id="root"></div>

  <script type="text/babel">
    const { useEffect, useMemo, useState } = React;

    // Poker 2025/2026 ‚Äì Dashboard m√≥vil v1.0 (React + Tailwind CSS)
    // ‚úÖ Optimizado para m√≥vil (vertical)
    // ‚úÖ Est√©tica minimalista con look & feel de poker
    // ‚úÖ Registro de jugadores (hasta 15) con foto an√≥nima clickable para subir foto
    // ‚úÖ Seguimiento de pagos (No pagado por defecto / Pagado con toggle)
    // ‚úÖ Calendario de partidas (fechas oficiales + partidas flotantes hasta 6/a√±o)
    // ‚úÖ Cada fecha tiene 2 mesas, con: anfitri√≥n (com√∫n), finalistas 1¬∫/2¬∫/3¬∫ y 2 fotos (mesa1/mesa2)
    // ‚úÖ Integrantes por mesa (seleccionables de la lista de jugadores) + secci√≥n desplegable
    // ‚úÖ Clasificaci√≥n general (suma de mejores 12 mesas por jugador; 1¬∫=6, 2¬∫=3, 3¬∫=1)
    // ‚úÖ Exportar / Importar JSON para copias de seguridad
    // ‚úÖ Secci√≥n de REGLAS con el texto proporcionado (con emojis)
    // ‚úÖ Persistencia local (localStorage) y sin dependencias externas

    /************************************
     * Utilidades y datos iniciales
     ************************************/
    const MAX_PLAYERS = 15;
    const MAX_FLOATING_PER_YEAR = 6;

    const OFFICIAL_DATES = [
      { date: "2025-09-12", label: "12 Septiembre 2025 (ya jugada)" },
      { date: "2025-09-26", label: "26 Septiembre 2025" },
      { date: "2025-10-24", label: "24 Octubre 2025" },
      { date: "2025-11-21", label: "21 Noviembre 2025" },
      { date: "2025-12-12", label: "12 Diciembre 2025" },
      { date: "2026-01-30", label: "30 Enero 2026" },
      { date: "2026-02-27", label: "27 Febrero 2026" },
      { date: "2026-03-27", label: "27 Marzo 2026" },
      { date: "2026-04-24", label: "24 Abril 2026" },
      { date: "2026-05-29", label: "29 Mayo 2026" },
      { date: "2026-06-12", label: "12 Junio 2026 (Gran Final)" },
    ];

    const EMPTY_AVATAR =
      "data:image/svg+xml;utf8," +
      encodeURIComponent(`<?xml version='1.0' encoding='UTF-8'?>
      <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'>
        <rect width='128' height='128' rx='16' fill='#0c7c3a'/>
        <circle cx='64' cy='48' r='22' fill='#e6f7ef'/>
        <rect x='24' y='78' width='80' height='34' rx='17' fill='#e6f7ef'/>
      </svg>`);

    function uid() { return Math.random().toString(36).slice(2, 10); }
    function save(key, value) { localStorage.setItem(key, JSON.stringify(value)); }
    function load(key, fallback) {
      try { const v = localStorage.getItem(key); return v ? JSON.parse(v) : fallback; }
      catch { return fallback; }
    }

    /************************************
     * Componentes UI b√°sicos
     ************************************/
    function AppHeader() {
      return (
        <div className="sticky top-0 z-40 bg-green-700 text-white">
          <div className="flex items-center gap-3 px-4 py-3">
            <LogoBadge />
            <div className="leading-tight">
              <div className="text-xs uppercase tracking-widest opacity-90">Dashboard</div>
              <h1 className="text-lg font-semibold">Poker 2025/2026</h1>
            </div>
          </div>
        </div>
      );
    }

    function LogoBadge() {
      return (
        <div className="flex items-center gap-2">
          <div className="bg-white/10 backdrop-blur px-3 py-2 rounded-xl border border-white/20">
            <div className="flex items-center gap-2">
              <PlayingCardIcon />
              <span className="font-medium">Texas Hold‚Äôem Poker</span>
            </div>
          </div>
        </div>
      );
    }

    function PlayingCardIcon() {
      return (
        <svg aria-hidden className="w-6 h-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="5" y="2" width="14" height="20" rx="2" className="fill-white/90" />
          <rect x="7" y="4" width="10" height="16" rx="1" className="fill-green-600" />
          <path d="M12 8l2 3h-4l2-3zm0 8l-2-3h4l-2 3z" className="fill-white" />
        </svg>
      );
    }

    function TabBar({ tab, setTab }) {
      const tabs = [
        { id: "jugadores", label: "üë§ Jugadores" },
        { id: "partidas", label: "üóì Partidas" },
        { id: "clasificacion", label: "üèÜ Clasificaci√≥n" },
        { id: "reglas", label: "üìú Reglas" },
        { id: "copias", label: "üíæ Copias" },
      ];
      return (
        <div className="sticky top-[60px] z-30 bg-white border-b border-gray-200">
          <div className="flex overflow-x-auto no-scrollbar">
            {tabs.map((t) => (
              <button
                key={t.id}
                className={`shrink-0 px-4 py-3 text-sm font-medium border-b-2 transition-colors ${
                  tab === t.id ? "border-green-600 text-green-700" : "border-transparent text-gray-600"
                }`}
                onClick={() => setTab(t.id)}
              >
                {t.label}
              </button>
            ))}
          </div>
        </div>
      );
    }

    /************************************
     * Modelo de datos
     ************************************/
    const defaultPlayers = Array.from({ length: MAX_PLAYERS }).map(() => ({
      id: uid(), name: "", photo: "", paid: false, // por defecto No pagado
    }));

    const defaultPartidas = OFFICIAL_DATES.map((d) => ({
      id: uid(), date: d.date, label: d.label, isFloating: false, host: "",
      mesas: [
        { id: uid(), name: "Mesa 1", finalists: { first: "", second: "", third: "" }, integrantes: [], photo: "" },
        { id: uid(), name: "Mesa 2", finalists: { first: "", second: "", third: "" }, integrantes: [], photo: "" },
      ],
    }));

    const defaultState = { players: defaultPlayers, partidas: defaultPartidas };

    /************************************
     * Helpers clasificaci√≥n
     ************************************/
    function computeLeaderboard(players, partidas) {
      const scoresByPlayer = new Map();
      function addScore(name, pts) {
        if (!name) return; const key = name.trim().toLowerCase(); if (!key) return;
        const arr = scoresByPlayer.get(key) || []; arr.push(pts); scoresByPlayer.set(key, arr);
      }
      partidas.forEach((p) => {
        p.mesas.forEach((m) => { addScore(m.finalists.first, 6); addScore(m.finalists.second, 3); addScore(m.finalists.third, 1); });
      });
      const rows = []; const nameMap = new Map();
      players.forEach((pl) => { if (pl.name) nameMap.set(pl.name.trim().toLowerCase(), pl.name.trim()); });
      for (const [key, arr] of scoresByPlayer.entries()) {
        const sorted = [...arr].sort((a, b) => b - a).slice(0, 12);
        const total = sorted.reduce((s, x) => s + x, 0);
        rows.push({ name: nameMap.get(key) || key, total, best12Count: sorted.length });
      }
      players.filter((p) => p.name.trim()).forEach((p) => {
        const key = p.name.trim().toLowerCase(); if (!scoresByPlayer.has(key)) rows.push({ name: p.name.trim(), total: 0, best12Count: 0 });
      });
      return rows.sort((a, b) => b.total - a.total || a.name.localeCompare(b.name));
    }

    /************************************
     * Subcomponentes funcionales
     ************************************/
    function PhotoInput({ value, onChange, label, fullContain = true }) {
      const handleFile = (e) => {
        const file = e.target.files?.[0]; if (!file) return;
        const url = URL.createObjectURL(file); onChange(url);
      };
      return (
        <div className="flex flex-col items-center gap-2">
          <label className="w-24 h-24 rounded-xl overflow-hidden bg-green-50 border border-green-200 flex items-center justify-center">
            {value ? (
              <img src={value} alt={label} className={`w-full h-full ${fullContain ? "object-contain" : "object-cover"}`} />
            ) : (
              <img src={EMPTY_AVATAR} alt="an√≥nimo" className="w-full h-full object-contain" />
            )}
            <input type="file" accept="image/*" className="hidden" onChange={handleFile} />
          </label>
          {label && <span className="text-xs text-gray-600">{label}</span>}
        </div>
      );
    }

    function TogglePaid({ paid, onToggle }) {
      return (
        <div className="flex w-full rounded-xl overflow-hidden border text-sm">
          <button className={`flex-1 px-3 py-2 font-medium ${paid ? "bg-white text-gray-700" : "bg-red-600 text-white"}`} onClick={() => onToggle(false)}>No pagado</button>
          <button className={`flex-1 px-3 py-2 font-medium ${paid ? "bg-green-600 text-white" : "bg-white text-gray-700"}`} onClick={() => onToggle(true)}>Pagado</button>
        </div>
      );
    }

    function PlayerCard({ player, onChange }) {
      return (
        <div className="p-3 bg-white rounded-2xl shadow-sm border flex gap-3 items-center">
          <PhotoInput value={player.photo} onChange={(url) => onChange({ ...player, photo: url })} />
          <div className="flex-1">
            <input className="w-full text-base font-medium bg-transparent outline-none border-b border-gray-200 focus:border-green-600 py-1" placeholder="Nombre y apellidos" value={player.name} onChange={(e) => onChange({ ...player, name: e.target.value })} />
            <div className="mt-2"><TogglePaid paid={player.paid} onToggle={(v) => onChange({ ...player, paid: v })} /></div>
          </div>
        </div>
      );
    }

    function PodioInputs({ finalists, setFinalists, players }) {
      const options = ["", ...players.map((p) => p.name).filter(Boolean)];
      return (
        <div className="grid grid-cols-1 gap-2">
          <SelectField label="ü•á 1¬∫" value={finalists.first} onChange={(v) => setFinalists({ ...finalists, first: v })} options={options} />
          <SelectField label="ü•à 2¬∫" value={finalists.second} onChange={(v) => setFinalists({ ...finalists, second: v })} options={options} />
          <SelectField label="ü•â 3¬∫" value={finalists.third} onChange={(v) => setFinalists({ ...finalists, third: v })} options={options} />
        </div>
      );
    }

    function SelectField({ label, value, onChange, options }) {
      return (
        <label className="flex items-center gap-2 text-sm">
          <span className="w-16 text-gray-700 shrink-0">{label}</span>
          <select className="flex-1 px-3 py-2 bg-white border rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500" value={value} onChange={(e) => onChange(e.target.value)}>
            {options.map((op) => (<option key={op} value={op}>{op || "‚Äî"}</option>))}
          </select>
        </label>
      );
    }

    function IntegrantesSelector({ value, onChange, players }) {
      const toggle = (id) => { const set = new Set(value); if (set.has(id)) set.delete(id); else set.add(id); onChange([...set]); };
      return (
        <div className="grid grid-cols-2 gap-2">
          {players.map((p) => (
            <label key={p.id} className="flex items-center gap-2 text-sm bg-white border rounded-xl px-2 py-2">
              <input type="checkbox" checked={value.includes(p.id)} onChange={() => toggle(p.id)} />
              <span className="truncate">{p.name || "(vac√≠o)"}</span>
            </label>
          ))}
        </div>
      );
    }

    function MesaEditor({ mesa, setMesa, players }) {
      const [open, setOpen] = useState(false);
      return (
        <div className="p-3 bg-white rounded-2xl shadow-sm border space-y-3">
          <div className="flex items-center justify-between">
            <h4 className="font-semibold">{mesa.name}</h4>
            <button className="text-sm text-green-700 underline" onClick={() => setOpen((v) => !v)}>{open ? "Ocultar integrantes" : "Mostrar integrantes"}</button>
          </div>
          <div className="grid grid-cols-2 gap-3">
            <PhotoInput value={mesa.photo} onChange={(url) => setMesa({ ...mesa, photo: url })} label="Subir foto" fullContain />
            <PodioInputs finalists={mesa.finalists} setFinalists={(f) => setMesa({ ...mesa, finalists: f })} players={players} />
          </div>
          {open && (
            <div className="pt-2">
              <div className="text-xs text-gray-500 mb-2">Selecciona los integrantes de la mesa</div>
              <IntegrantesSelector value={mesa.integrantes} onChange={(list) => setMesa({ ...mesa, integrantes: list })} players={players} />
            </div>
          )}
        </div>
      );
    }

    function PartidaCard({ partida, setPartida, players, floatingCount, canCreateFloating, onCreateFloating }) {
      return (
        <div className="p-3 bg-emerald-50 border border-emerald-200 rounded-2xl space-y-3">
          <div className="flex items-center gap-2">
            <span className="px-2 py-1 text-xs rounded-full bg-emerald-700 text-white">{partida.isFloating ? "FLOTANTE" : "OFICIAL"}</span>
            <input type="date" className="px-3 py-2 rounded-xl border bg-white" value={partida.date} onChange={(e) => setPartida({ ...partida, date: e.target.value })} />
            <span className="text-xs text-gray-600">{partida.label || ""}</span>
          </div>
          <label className="flex items-center gap-2 text-sm">
            <span className="w-20 text-gray-700 shrink-0">Anfitri√≥n</span>
            <select className="flex-1 px-3 py-2 bg-white border rounded-xl" value={partida.host} onChange={(e) => setPartida({ ...partida, host: e.target.value })}>
              <option value="">‚Äî</option>
              {players.filter((p) => p.name.trim()).map((p) => (<option key={p.id} value={p.name}>{p.name}</option>))}
            </select>
          </label>
          <div className="grid grid-cols-1 gap-3">
            {partida.mesas.map((m, idx) => (
              <MesaEditor key={m.id} mesa={m} setMesa={(newMesa) => { const copy = { ...partida, mesas: [...partida.mesas] }; copy.mesas[idx] = newMesa; setPartida(copy); }} players={players} />
            ))}
          </div>
          {canCreateFloating && (
            <div className="flex items-center justify-between pt-2">
              <span className="text-xs text-gray-600">Partidas flotantes creadas: {floatingCount}/{MAX_FLOATING_PER_YEAR}</span>
              <button className="px-3 py-2 rounded-xl bg-green-600 text-white text-sm" onClick={onCreateFloating}>+ Crear partida flotante</button>
            </div>
          )}
        </div>
      );
    }

    /************************************
     * Vistas principales
     ************************************/
    function JugadoresView({ state, setState }) {
      const { players } = state;
      const updatePlayer = (i, p) => { const next = [...players]; next[i] = p; setState({ ...state, players: next }); };
      const filled = players.filter((p) => p.name.trim()).length;
      return (
        <div className="p-4 space-y-3">
          <div classN
