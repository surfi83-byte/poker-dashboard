<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poker Tournament Dashboard 2025/2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        .bg-green-750 {
            background-color: #166534;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-green-900 via-green-800 to-black text-white">
    <!-- Header -->
    <div class="bg-gradient-to-r from-green-600 to-green-700 p-4 shadow-2xl">
        <div class="flex items-center justify-center mb-2">
            <div class="bg-green-500 rounded-lg p-2 mr-3">
                <span class="text-2xl">♠️</span>
            </div>
            <h1 class="text-2xl font-bold text-center">Texas Hold'em Poker</h1>
        </div>
        <h2 class="text-xl text-center font-semibold text-green-100">
            Poker 2025/2026
        </h2>
    </div>

    <!-- Navigation -->
    <div class="flex overflow-x-auto bg-green-700 shadow-lg">
        <button onclick="showSection('players')" id="nav-players" class="nav-btn flex-1 p-3 flex items-center justify-center space-x-2 font-medium transition-all bg-green-800 text-white border-b-2 border-green-300">
            <span>👥</span>
            <span class="text-sm">Jugadores</span>
        </button>
        <button onclick="showSection('matches')" id="nav-matches" class="nav-btn flex-1 p-3 flex items-center justify-center space-x-2 font-medium transition-all text-green-100 hover:bg-green-600">
            <span>📅</span>
            <span class="text-sm">Partidas</span>
        </button>
        <button onclick="showSection('ranking')" id="nav-ranking" class="nav-btn flex-1 p-3 flex items-center justify-center space-x-2 font-medium transition-all text-green-100 hover:bg-green-600">
            <span>🏆</span>
            <span class="text-sm">Ranking</span>
        </button>
        <button onclick="showSection('rules')" id="nav-rules" class="nav-btn flex-1 p-3 flex items-center justify-center space-x-2 font-medium transition-all text-green-100 hover:bg-green-600">
            <span>📜</span>
            <span class="text-sm">Reglas</span>
        </button>
    </div>

    <!-- Export/Import Controls -->
    <div class="p-4 bg-green-800 flex justify-center space-x-4">
        <button onclick="exportData()" class="flex items-center space-x-2 bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg transition-colors">
            <span>⬇️</span>
            <span>Exportar</span>
        </button>
        <button onclick="document.getElementById('import-file').click()" class="flex items-center space-x-2 bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-lg transition-colors">
            <span>⬆️</span>
            <span>Importar</span>
        </button>
        <input type="file" id="import-file" accept=".json" onchange="importData(event)" class="hidden">
    </div>

    <!-- Content -->
    <div class="p-4">
        <!-- Players Section -->
        <div id="players-section" class="section">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold">Jugadores Registrados</h3>
                <button onclick="addPlayer()" class="flex items-center space-x-2 bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg transition-colors">
                    <span>➕</span>
                    <span>Agregar</span>
                </button>
            </div>
            <div id="players-container" class="grid gap-4"></div>
        </div>

        <!-- Matches Section -->
        <div id="matches-section" class="section hidden">
            <h3 class="text-xl font-bold mb-6">Calendario de Partidas</h3>
            <div id="matches-container" class="space-y-4"></div>
            
            <div class="mt-8 text-center">
                <button onclick="addFloatingMatch()" class="bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-700 hover:to-orange-700 text-white px-6 py-3 rounded-xl font-medium transition-all transform hover:scale-105 shadow-lg">
                    ➕ Agregar Partida Flotante
                </button>
            </div>

            <!-- Gran Final -->
            <div class="mt-8 bg-gradient-to-br from-yellow-600 via-orange-600 to-red-600 rounded-xl p-6 shadow-2xl">
                <h4 class="text-2xl font-bold text-center text-white mb-2">🏆 GRAN FINAL</h4>
                <p class="text-center text-yellow-100 text-lg font-semibold">12 de Junio 2026</p>
                <p class="text-center text-yellow-200 mt-2">Los 6 mejores jugadores de la temporada</p>
            </div>
        </div>

        <!-- Ranking Section -->
        <div id="ranking-section" class="section hidden">
            <h3 class="text-xl font-bold mb-6">🏆 Clasificación General</h3>
            <div class="bg-gradient-to-br from-green-800 to-green-900 rounded-xl p-6 shadow-xl">
                <div id="ranking-container">
                    <p class="text-center text-green-300 text-lg mb-6">
                        El ranking se actualizará automáticamente basado en los resultados de las partidas.
                    </p>
                </div>
                <div class="mt-6 text-center">
                    <div class="inline-block bg-green-700 rounded-lg p-4">
                        <h4 class="font-bold text-green-300 mb-2">Sistema de Puntuación</h4>
                        <div class="text-sm space-y-1">
                            <p>🥇 1er lugar: 6 puntos</p>
                            <p>🥈 2do lugar: 3 puntos</p>
                            <p>🥉 3er lugar: 1 punto</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Rules Section -->
        <div id="rules-section" class="section hidden">
            <div class="bg-gradient-to-br from-green-800 to-green-900 rounded-xl p-6 shadow-2xl">
                <h3 class="text-2xl font-bold mb-6 text-center text-green-300">🎯 REGLAS DEL TORNEO</h3>
                
                <div class="space-y-6 text-sm leading-relaxed">
                    <div>
                        <h4 class="text-lg font-semibold text-green-300 mb-3">💰 Entrada</h4>
                        <ul class="space-y-2 pl-4">
                            <li>• Costo: $50 USD</li>
                            <li>• 💳 Pago a: Eliuth Triana</li>
                            <li>• 🧾 Los participantes no acumularán puntos para la clasificación general hasta confirmar participación y pago</li>
                        </ul>
                    </div>

                    <div>
                        <h4 class="text-lg font-semibold text-green-300 mb-3">🃏 Participantes externos</h4>
                        <ul class="space-y-2 pl-4">
                            <li>• 👥 Pueden jugar en las mesas (a discreción del anfitrión)</li>
                            <li>• 🏆 Acceden al premio de la mesa</li>
                            <li>• 🚫 No acumulan puntos para el torneo</li>
                        </ul>
                    </div>

                    <div>
                        <h4 class="text-lg font-semibold text-green-300 mb-3">📅 Fechas oficiales</h4>
                        <ul class="space-y-1 pl-4">
                            <li>• 🗓 12 Septiembre</li>
                            <li>• 🗓 26 Septiembre</li>
                            <li>• 🗓 24 Octubre</li>
                            <li>• 🗓 21 Noviembre</li>
                            <li>• 🗓 12 Diciembre</li>
                            <li>• 🗓 30 Enero</li>
                            <li>• 🗓 27 Febrero</li>
                            <li>• 🗓 27 Marzo</li>
                            <li>• 🗓 24 Abril</li>
                            <li>• 🗓 29 Mayo</li>
                        </ul>
                    </div>

                    <div>
                        <h4 class="text-lg font-semibold text-green-300 mb-3">➕ Fechas adicionales</h4>
                        <ul class="space-y-2 pl-4">
                            <li>• 🔄 Máximo 2 por mes</li>
                            <li>• 👥 Requiere mínimo 6 jugadores del torneo</li>
                        </ul>
                    </div>

                    <div>
                        <h4 class="text-lg font-semibold text-green-300 mb-3">🎉 Gran Final</h4>
                        <p class="pl-4">• 📍 Fecha: 12 de Junio</p>
                    </div>

                    <div>
                        <h4 class="text-lg font-semibold text-green-300 mb-3">🏆 Sistema de puntuación</h4>
                        <ul class="space-y-2 pl-4">
                            <li>• 🥇 1er lugar: 6 puntos</li>
                            <li>• 🥈 2do lugar: 3 puntos</li>
                            <li>• 🥉 3er lugar: 1 punto</li>
                            <li>• 📊 Se consideran las 12 mejores mesas</li>
                            <li>• ➕ Si no se llega a 12, se suman los puntos acumulados</li>
                        </ul>
                    </div>

                    <div>
                        <h4 class="text-lg font-semibold text-green-300 mb-3">🎖 Finalistas</h4>
                        <ul class="space-y-2 pl-4">
                            <li>• 👑 Los 6 mejores jugadores acceden a la mesa final</li>
                            <li>• 🔄 Si alguien no puede asistir, entra el siguiente en la tabla</li>
                        </ul>
                    </div>

                    <div>
                        <h4 class="text-lg font-semibold text-green-300 mb-3">⚖️ Desempates</h4>
                        <p class="pl-4">1️⃣ Veces en 1er lugar 2️⃣ Veces en 2do lugar 3️⃣ Veces en 3er lugar 🎩 Veces como anfitrión</p>
                    </div>

                    <div>
                        <h4 class="text-lg font-semibold text-green-300 mb-3">💵 Premios</h4>
                        <ul class="space-y-2 pl-4">
                            <li>• 🏆 Ganador de la temporada: $xx.xx</li>
                            <li>• 🃏 Mesa de finalistas:</li>
                            <li class="pl-4">o 🥇 1er lugar: $xx.xx</li>
                            <li class="pl-4">o 🥈 2do lugar: $xx.xx</li>
                            <li class="pl-4">o 🥉 3er lugar: $50</li>
                        </ul>
                    </div>

                    <div>
                        <h4 class="text-lg font-semibold text-green-300 mb-3">⏱ Estructura de Blinds</h4>
                        <div class="bg-green-900 rounded-lg p-4 overflow-x-auto">
                            <table class="w-full text-xs">
                                <thead>
                                    <tr class="border-b border-green-600">
                                        <th class="p-2">🧮 Nivel</th>
                                        <th class="p-2">💵 Small Blind</th>
                                        <th class="p-2">💵 Big Blind</th>
                                        <th class="p-2">⏳ Duración</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b border-green-800"><td class="p-2 text-center">1</td><td class="p-2 text-center">50</td><td class="p-2 text-center">100</td><td class="p-2 text-center">15 min</td></tr>
                                    <tr class="border-b border-green-800"><td class="p-2 text-center">2</td><td class="p-2 text-center">100</td><td class="p-2 text-center">200</td><td class="p-2 text-center">10 min</td></tr>
                                    <tr class="border-b border-green-800"><td class="p-2 text-center">3</td><td class="p-2 text-center">200</td><td class="p-2 text-center">400</td><td class="p-2 text-center">10 min</td></tr>
                                    <tr class="border-b border-green-800"><td class="p-2 text-center">4</td><td class="p-2 text-center">300</td><td class="p-2 text-center">600</td><td class="p-2 text-center">10 min</td></tr>
                                    <tr class="border-b border-green-800"><td class="p-2 text-center">5</td><td class="p-2 text-center">500</td><td class="p-2 text-center">1000</td><td class="p-2 text-center">10 min</td></tr>
                                    <tr class="border-b border-green-800"><td class="p-2 text-center">6</td><td class="p-2 text-center">1000</td><td class="p-2 text-center">2000</td><td class="p-2 text-center">10 min</td></tr>
                                    <tr class="border-b border-green-800"><td class="p-2 text-center">7</td><td class="p-2 text-center">2000</td><td class="p-2 text-center">4000</td><td class="p-2 text-center">10 min</td></tr>
                                    <tr class="border-b border-green-800"><td class="p-2 text-center">8</td><td class="p-2 text-center">4000</td><td class="p-2 text-center">8000</td><td class="p-2 text-center">10 min</td></tr>
                                    <tr class="border-b border-green-800"><td class="p-2 text-center">9</td><td class="p-2 text-center">5000</td><td class="p-2 text-center">10000</td><td class="p-2 text-center">10 min</td></tr>
                                    <tr class="border-b border-green-800"><td class="p-2 text-center">10</td><td class="p-2 text-center">10000</td><td class="p-2 text-center">20000</td><td class="p-2 text-center">10 min</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div>
                        <h4 class="text-lg font-semibold text-green-300 mb-3">📜 REGLAS GENERALES</h4>
                        <ul class="space-y-2 pl-4 text-sm">
                            <li>• 🃏 Dealer inicial: carta más alta (en empate, se reparte otra)</li>
                            <li>• 🧍‍♂️ Final de mesa: cuando quedan 3 jugadores</li>
                            <li>• ⚔️ Eliminación simultánea: se usa el stack inicial para definir posición</li>
                            <li>• 💱 Cambio de fichas: se reemplazan fichas pequeñas por grandes; fracciones se redondean</li>
                            <li>• ❌ Misdeals:</li>
                            <li class="pl-4">o 🃎 Cartas expuestas por el dealer</li>
                            <li class="pl-4">o 🃎 Más de 2 cartas adicionales en mano inicial</li>
                            <li class="pl-4">o 🃎 Cartas encajonadas</li>
                            <li class="pl-4">o 🃎 Reparto a asiento vacío o falta de reparto a jugador activo</li>
                            <li class="pl-4">o 🃎 Reparto fuera de secuencia</li>
                            <li class="pl-4">o 🃎 Cantidad incorrecta de cartas (si no se puede corregir sin alterar secuencia)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global data
        let players = [
            { id: 1, name: '', photo: null, paid: false },
            { id: 2, name: '', photo: null, paid: false },
            { id: 3, name: '', photo: null, paid: false }
        ];

        const officialDates = [
            { date: '12 Septiembre', played: true },
            { date: '26 Septiembre', played: false },
            { date: '24 Octubre', played: false },
            { date: '21 Noviembre', played: false },
            { date: '12 Diciembre', played: false },
            { date: '30 Enero', played: false },
            { date: '27 Febrero', played: false },
            { date: '27 Marzo', played: false },
            { date: '24 Abril', played: false },
            { date: '29 Mayo', played: false }
        ];

        let matches = officialDates.map((dateInfo, index) => ({
            id: index + 1,
            date: dateInfo.date,
            played: dateInfo.played,
            isFloating: false,
            host: '',
            showHost: false,
            mesa1: { first: '', second: '', third: '', photo: null },
            mesa2: { first: '', second: '', third: '', photo: null }
        }));

        let floatingMatches = [];

        // Navigation
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });

            // Remove active class from all nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-green-800', 'text-white', 'border-b-2', 'border-green-300');
                btn.classList.add('text-green-100', 'hover:bg-green-600');
            });

            // Show selected section
            document.getElementById(sectionName + '-section').classList.remove('hidden');

            // Add active class to selected nav button
            const activeBtn = document.getElementById('nav-' + sectionName);
            activeBtn.classList.add('bg-green-800', 'text-white', 'border-b-2', 'border-green-300');
            activeBtn.classList.remove('text-green-100', 'hover:bg-green-600');

            // Update content if needed
            if (sectionName === 'players') {
                renderPlayers();
            } else if (sectionName === 'matches') {
                renderMatches();
            } else if (sectionName === 'ranking') {
                renderRanking();
            }
        }

        // Players functions
        function addPlayer() {
            if (players.length < 15) {
                players.push({
                    id: Date.now(),
                    name: '',
                    photo: null,
                    paid: false
                });
                renderPlayers();
            }
        }

        function updatePlayer(id, field, value) {
            players = players.map(player => 
                player.id === id ? { ...player, [field]: value } : player
            );
            renderPlayers();
            if (!document.getElementById('matches-section').classList.contains('hidden')) {
                renderMatches();
            }
        }

        function handlePhotoUpload(playerId, event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    updatePlayer(playerId, 'photo', e.target.result);
                };
                reader.readAsDataURL(file);
            }
        }

        function renderPlayers() {
            const container = document.getElementById('players-container');
            container.innerHTML = '';

            players.forEach(player => {
                const playerDiv = document.createElement('div');
                playerDiv.className = 'bg-gradient-to-r from-green-800 to-green-900 rounded-xl p-4 shadow-lg';
                
                playerDiv.innerHTML = `
                    <div class="flex items-center space-x-4">
                        <div class="relative">
                            <div onclick="selectPhoto(${player.id})" class="w-16 h-16 bg-green-700 rounded-full flex items-center justify-center cursor-pointer hover:bg-green-600 transition-colors overflow-hidden">
                                ${player.photo ? 
                                    `<img src="${player.photo}" alt="Jugador" class="w-full h-full object-cover rounded-full">` :
                                    `<span class="text-green-300 text-2xl">📷</span>`
                                }
                            </div>
                            <input type="file" id="photo-${player.id}" accept="image/*" onchange="handlePhotoUpload(${player.id}, event)" class="hidden">
                        </div>
                        
                        <div class="flex-1">
                            <input
                                type="text"
                                placeholder="Nombre y Apellidos"
                                value="${player.name}"
                                onchange="updatePlayer(${player.id}, 'name', this.value)"
                                class="w-full bg-green-700 text-white placeholder-green-300 px-3 py-2 rounded-lg border border-green-600 focus:border-green-400 focus:outline-none"
                            />
                        </div>
                    </div>
                    
                    <div class="mt-3">
                        <button
                            onclick="updatePlayer(${player.id}, 'paid', ${!player.paid})"
                            class="w-full py-2 px-4 rounded-lg font-medium transition-all ${
                                player.paid 
                                    ? 'bg-green-500 hover:bg-green-400 text-white' 
                                    : 'bg-red-600 hover:bg-red-500 text-white'
                            }"
                        >
                            ${player.paid ? '✅ PAGADO' : '❌ NO PAGADO'}
                        </button>
                    </div>
                `;
                
                container.appendChild(playerDiv);
            });
        }

        function selectPhoto(playerId) {
            document.getElementById(`photo-${playerId}`).click();
        }

        // Matches functions
        function addFloatingMatch() {
            const newMatch = {
                id: Date.now(),
                date: '',
                played: false,
                isFloating: true,
                host: '',
                showHost: false,
                mesa1: { first: '', second: '', third: '', photo: null },
                mesa2: { first: '', second: '', third: '', photo: null }
            };
            floatingMatches.push(newMatch);
            matches.push(newMatch);
            renderMatches();
        }

        function updateMatch(matchId, field, value, mesa = null) {
            const updateFn = (match) => {
                if (match.id === matchId) {
                    if (mesa) {
                        return { ...match, [mesa]: { ...match[mesa], [field]: value } };
                    }
                    return { ...match, [field]: value };
                }
                return match;
            };
            
            matches = matches.map(updateFn);
            floatingMatches = floatingMatches.map(updateFn);
            renderMatches();
        }

        function toggleHost(matchId) {
            const updateFn = (match) => 
                match.id === matchId ? { ...match, showHost: !match.showHost } : match;
            
            matches = matches.map(updateFn);
            floatingMatches = floatingMatches.map(updateFn);
            renderMatches();
        }

        function handleMesaPhotoUpload(matchId, mesa, event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    updateMatch(matchId, 'photo', e.target.result, mesa);
                };
                reader.readAsDataURL(file);
            }
        }

        function selectMesaPhoto(matchId, mesa) {
            document.getElementById(`mesa-photo-${matchId}-${mesa}`).click();
        }

        function renderMatches() {
            const container = document.getElementById('matches-container');
            container.innerHTML = '';

            const allMatches = [...matches.filter(m => !m.isFloating), ...floatingMatches];

            allMatches.forEach(match => {
                const matchDiv = document.createElement('div');
                matchDiv.className = 'bg-gradient-to-br from-green-800 to-green-900 rounded-xl shadow-lg overflow-hidden';
                
                const playerOptions = players.filter(p => p.name.trim()).map(player => 
                    `<option value="${player.name}">${player.name}</option>`
                ).join('');

                matchDiv.innerHTML = `
                    <div class="p-4 bg-green-700 flex justify-between items-center">
                        <div>
                            <h4 class="font-bold text-lg">
                                ${match.isFloating ? 
                                    `<input type="text" placeholder="Fecha (ej: 15 Octubre)" value="${match.date}" onchange="updateMatch(${match.id}, 'date', this.value)" class="bg-green-600 text-white placeholder-green-300 px-2 py-1 rounded border border-green-500 focus:border-green-300 focus:outline-none">` :
                                    match.date
                                }
                                ${match.isFloating ? '<span class="ml-2 text-sm bg-yellow-600 px-2 py-1 rounded">FLOTANTE</span>' : ''}
                            </h4>
                        </div>
                        <button onclick="toggleHost(${match.id})" class="text-green-300 hover:text-green-100">
                            ${match.showHost ? '🔼' : '🔽'}
                        </button>
                    </div>

                    ${match.showHost ? `
                        <div class="p-4 bg-green-750">
                            <input type="text" placeholder="Nombre del Anfitrión" value="${match.host}" onchange="updateMatch(${match.id}, 'host', this.value)" class="w-full bg-green-700 text-white placeholder-green-300 px-3 py-2 rounded-lg border border-green-600 focus:border-green-400 focus:outline-none">
                        </div>
                    ` : ''}

                    <div class="p-4 space-y-6">
                        ${['mesa1', 'mesa2'].map((mesa, index) => `
                            <div class="bg-green-800 rounded-lg p-4">
                                <div class="flex justify-between items-center mb-4">
                                    <h5 class="font-semibold text-green-300">Mesa ${index + 1}</h5>
                                    <button onclick="selectMesaPhoto(${match.id}, '${mesa}')" class="flex items-center space-x-2 bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm transition-colors">
                                        <span>📷</span>
                                        <span>Foto Mesa</span>
                                    </button>
                                    <input type="file" id="mesa-photo-${match.id}-${mesa}" accept="image/*" onchange="handleMesaPhotoUpload(${match.id}, '${mesa}', event)" class="hidden">
                                </div>

                                ${match[mesa].photo ? `
                                    <div class="mb-4">
                                        <img src="${match[mesa].photo}" alt="Foto Mesa ${index + 1}" class="w-full h-auto max-h-64 object-contain rounded-lg border-2 border-green-600">
                                    </div>
                                ` : ''}

                                <div class="grid gap-3">
                                    ${['first', 'second', 'third'].map((position, posIndex) => `
                                        <div class="flex items-center space-x-3">
                                            <span class="text-sm font-medium text-green-300 w-12">
                                                ${posIndex === 0 ? '🥇 1°' : posIndex === 1 ? '🥈 2°' : '🥉 3°'}
                                            </span>
                                            <select
                                                value="${match[mesa][position] || ''}"
                                                onchange="updateMatch(${match.id}, '${position}', this.value, '${mesa}')"
                                                class="flex-1 bg-green-700 text-white px-3 py-2 rounded border border-green-600 focus:border-green-400 focus:outline-none"
                                            >
                                                <option value="">Seleccionar jugador</option>
                                                ${playerOptions}
                                            </select>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                container.appendChild(matchDiv);
            });
        }

        function renderRanking() {
            const container = document.getElementById('ranking-container');
            
            // Calculate player rankings
            const playerStats = {};
            
            // Initialize stats for all players
            players.forEach(player => {
                if (player.name.trim()) {
                    playerStats[player.name] = {
                        name: player.name,
                        points: 0,
                        first: 0,
                        second: 0,
                        third: 0,
                        hostCount: 0,
                        paid: player.paid
                    };
                }
            });

            // Calculate points from matches
            const allMatches = [...matches.filter(m => !m.isFloating), ...floatingMatches];
            allMatches.forEach(match => {
                if (match.host && playerStats[match.host]) {
                    playerStats[match.host].hostCount++;
                }

                ['mesa1', 'mesa2'].forEach(mesa => {
                    const mesaData = match[mesa];
                    if (mesaData.first && playerStats[mesaData.first]) {
                        playerStats[mesaData.first].points += 6;
                        playerStats[mesaData.first].first++;
                    }
                    if (mesaData.second && playerStats[mesaData.second]) {
                        playerStats[mesaData.second].points += 3;
                        playerStats[mesaData.second].second++;
                    }
                    if (mesaData.third && playerStats[mesaData.third]) {
                        playerStats[mesaData.third].points += 1;
                        playerStats[mesaData.third].third++;
                    }
                });
            });

            // Sort players by ranking criteria
            const sortedPlayers = Object.values(playerStats).sort((a, b) => {
                if (b.points !== a.points) return b.points - a.points;
                if (b.first !== a.first) return b.first - a.first;
                if (b.second !== a.second) return b.second - a.second;
                if (b.third !== a.third) return b.third - a.third;
                return b.hostCount - a.hostCount;
            });

            if (sortedPlayers.length === 0) {
                container.innerHTML = `
                    <p class="text-center text-green-300 text-lg mb-6">
                        El ranking se actualizará automáticamente basado en los resultados de las partidas.
                    </p>
                `;
                return;
            }

            container.innerHTML = `
                <div class="space-y-4">
                    ${sortedPlayers.map((player, index) => `
                        <div class="flex items-center justify-between p-4 bg-green-700 rounded-lg ${!player.paid ? 'opacity-75 border-2 border-red-500' : ''}">
                            <div class="flex items-center space-x-4">
                                <span class="text-2xl font-bold text-green-300">${index + 1}</span>
                                <div>
                                    <div class="font-semibold text-lg">${player.name}</div>
                                    <div class="text-sm text-green-300">
                                        🥇${player.first} 🥈${player.second} 🥉${player.third} 🎩${player.hostCount}
                                    </div>
                                    ${!player.paid ? '<div class="text-xs text-red-300">⚠️ No pagado - Sin puntos oficiales</div>' : ''}
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-2xl font-bold text-yellow-400">${player.paid ? player.points : 0}</div>
                                <div class="text-sm text-green-300">puntos</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // Export/Import functions
        function exportData() {
            const data = {
                players,
                matches: [...matches, ...floatingMatches],
                exportDate: new Date().toISOString()
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'poker-tournament-backup.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function importData(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = JSON.parse(e.target.result);
                        if (data.players) {
                            players = data.players;
                        }
                        if (data.matches) {
                            const official = data.matches.filter(m => !m.isFloating);
                            const floating = data.matches.filter(m => m.isFloating);
                            matches = official;
                            floatingMatches = floating;
                        }
                        // Refresh current view
                        const currentSection = document.querySelector('.section:not(.hidden)').id.replace('-section', '');
                        showSection(currentSection);
                        alert('Datos importados correctamente');
                    } catch (error) {
                        alert('Error al importar el archivo. Verifica que sea un archivo JSON válido.');
                    }
                };
                reader.readAsText(file);
            }
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            showSection('players');
        });
    </script>
</body>
</html>
